<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Interface - OpsNow Copilot</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        :root {
            --primary: #3B82F6;
            --secondary: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --purple: #8B5CF6;
            --dark: #1F2937;
            --light: #F3F4F6;
            --white: #FFFFFF;
            --client: #3B82F6;
            --server: #10B981;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            line-height: 1.7;
            color: var(--dark);
            background: linear-gradient(135deg, #0f172a 0%, #1e3a5f 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container { max-width: 1100px; margin: 0 auto; }

        header {
            text-align: center;
            color: var(--white);
            margin-bottom: 40px;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .card {
            background: var(--white);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .card h2 {
            color: var(--primary);
            font-size: 1.4rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #DBEAFE;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card h3 {
            color: var(--dark);
            font-size: 1.1rem;
            margin: 25px 0 15px 0;
        }

        .direction-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-client { background: #DBEAFE; color: #1E40AF; }
        .badge-server { background: #D1FAE5; color: #065F46; }
        .badge-timeout { background: #FEF3C7; color: #92400E; }
        .badge-size { background: #EDE9FE; color: #5B21B6; }

        .message-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .message-grid { grid-template-columns: 1fr; }
        }

        .message-card {
            background: var(--light);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid var(--primary);
        }

        .message-card.server { border-left-color: var(--secondary); }
        .message-card.large-data { border-left-color: var(--purple); }

        .message-card h4 {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .message-card h4 code {
            background: var(--dark);
            color: var(--white);
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
        }

        .message-card p {
            color: #6B7280;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .message-card .meta {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .tech-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 0.9rem;
        }

        .tech-table th {
            background: var(--light);
            padding: 12px 15px;
            text-align: left;
            border-bottom: 2px solid #E5E7EB;
            font-weight: 600;
        }

        .tech-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #E5E7EB;
        }

        .tech-table code {
            background: #E5E7EB;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .code-block {
            background: #1F2937;
            color: #E5E7EB;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.85rem;
            overflow-x: auto;
            margin: 15px 0;
            white-space: pre;
        }

        .code-block .keyword { color: #C792EA; }
        .code-block .type { color: #FFCB6B; }
        .code-block .string { color: #C3E88D; }
        .code-block .comment { color: #6B7280; }
        .code-block .property { color: #82AAFF; }

        .mermaid-container {
            background: #F8FAFC;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #E2E8F0;
            overflow-x: auto;
        }

        .mermaid { display: flex; justify-content: center; }

        .flow-section {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 900px) {
            .flow-section { grid-template-columns: 1fr; }
        }

        .flow-card {
            background: var(--light);
            border-radius: 12px;
            padding: 20px;
        }

        .flow-card h4 {
            color: var(--dark);
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .flow-card .mermaid {
            background: var(--white);
            border-radius: 8px;
            padding: 15px;
            overflow-x: auto;
        }

        .highlight-box {
            background: linear-gradient(135deg, #EEF2FF 0%, #E0E7FF 100%);
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 0 12px 12px 0;
            margin: 20px 0;
        }

        .highlight-box.warning {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border-left-color: var(--warning);
        }

        .highlight-box.purple {
            background: linear-gradient(135deg, #EDE9FE 0%, #DDD6FE 100%);
            border-left-color: var(--purple);
        }

        .highlight-box h4 {
            margin-bottom: 8px;
            color: var(--dark);
        }

        .arrow-diagram {
            font-family: 'Fira Code', monospace;
            background: #1E293B;
            color: #E2E8F0;
            padding: 20px;
            border-radius: 10px;
            font-size: 0.8rem;
            overflow-x: auto;
            white-space: pre;
            line-height: 1.5;
        }

        .arrow-diagram .client { color: #60A5FA; }
        .arrow-diagram .server { color: #34D399; }
        .arrow-diagram .message { color: #FBBF24; }
        .arrow-diagram .comment { color: #6B7280; }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }

        .stat-card {
            background: var(--light);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-card .label {
            font-size: 0.85rem;
            color: #6B7280;
            margin-top: 5px;
        }

        footer {
            text-align: center;
            color: var(--white);
            padding: 30px 0;
            opacity: 0.7;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>WebSocket Interface</h1>
            <p class="subtitle">OpsNow Copilot - 클라이언트-서버 메시지 인터페이스 정의</p>
        </header>

        <!-- 개요 -->
        <div class="card">
            <h2>개요</h2>

            <div class="mermaid-container">
                <div class="mermaid">
flowchart LR
    subgraph Client["Client (Browser)"]
        Widget["Copilot Widget"]
        IDB["IndexedDB"]
    end

    subgraph Server["Server (FastAPI)"]
        WS["WebSocket Handler"]
        React["ReAct Loop"]
    end

    Widget -->|"C→S 메시지"| WS
    WS -->|"S→C 메시지"| Widget
    IDB -.->|"대용량 데이터"| Widget

    style Widget fill:#3B82F6,color:#fff
    style WS fill:#10B981,color:#fff
    style React fill:#8B5CF6,color:#fff
    style IDB fill:#F59E0B,color:#000
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="value">7</div>
                    <div class="label">C→S 메시지</div>
                </div>
                <div class="stat-card">
                    <div class="value">9</div>
                    <div class="label">S→C 메시지</div>
                </div>
                <div class="stat-card">
                    <div class="value">2</div>
                    <div class="label">콜백 패턴</div>
                </div>
                <div class="stat-card">
                    <div class="value">2</div>
                    <div class="label">대용량 처리</div>
                </div>
            </div>
        </div>

        <!-- Client → Server -->
        <div class="card">
            <h2><span class="direction-badge badge-client">C→S</span> Client → Server 메시지</h2>

            <div class="message-grid">
                <div class="message-card">
                    <h4><code>query</code> 사용자 질의</h4>
                    <p>사용자 질문 + DOM 컨텍스트 (~2000 토큰) + 페이지 정보</p>
                    <div class="meta">
                        <span class="direction-badge badge-size">~50KB</span>
                    </div>
                </div>

                <div class="message-card">
                    <h4><code>human_response</code> 사용자 입력</h4>
                    <p>ask_human 도구의 clarification_request에 대한 응답</p>
                    <div class="meta">
                        <span class="direction-badge badge-timeout">← clarification_request</span>
                    </div>
                </div>

                <div class="message-card">
                    <h4><code>available_data</code> IndexedDB 목록</h4>
                    <p>request_available_data 요청에 대한 IndexedDB 데이터 목록 응답</p>
                    <div class="meta">
                        <span class="direction-badge badge-timeout">← request_available_data</span>
                    </div>
                </div>

                <div class="message-card">
                    <h4><code>api_result</code> IndexedDB 데이터</h4>
                    <p>request_api 요청에 대한 IndexedDB 데이터 조회 결과</p>
                    <div class="meta">
                        <span class="direction-badge badge-size">~100KB</span>
                        <span class="direction-badge badge-timeout">← request_api</span>
                    </div>
                </div>

                <div class="message-card large-data">
                    <h4><code>schema_response</code> IndexedDB 스키마</h4>
                    <p>IndexedDB 대용량 데이터의 스키마 (필드, 타입, 레코드 수)</p>
                    <div class="meta">
                        <span class="direction-badge badge-size">~2KB</span>
                        <span class="direction-badge" style="background:#EDE9FE;color:#5B21B6;">대용량</span>
                    </div>
                </div>

                <div class="message-card large-data">
                    <h4><code>code_result</code> IndexedDB 코드 실행 결과</h4>
                    <p>IndexedDB 데이터에 대해 JavaScript 코드 실행 결과</p>
                    <div class="meta">
                        <span class="direction-badge badge-size">~1KB</span>
                        <span class="direction-badge" style="background:#EDE9FE;color:#5B21B6;">대용량</span>
                    </div>
                </div>

                <div class="message-card">
                    <h4><code>pong</code> 하트비트 응답</h4>
                    <p>서버 ping에 대한 응답</p>
                    <div class="meta">
                        <span class="direction-badge badge-timeout">← ping</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Server → Client -->
        <div class="card">
            <h2><span class="direction-badge badge-server">S→C</span> Server → Client 메시지</h2>

            <div class="message-grid">
                <div class="message-card server">
                    <h4><code>connected</code> 연결 확인</h4>
                    <p>WebSocket 연결 성공 알림</p>
                    <div class="meta"></div>
                </div>

                <div class="message-card server">
                    <h4><code>clarification_request</code> 추가 질문</h4>
                    <p>ask_human 도구 - 모호한 질문, 위험 액션 확인</p>
                    <div class="meta">
                        <span class="direction-badge badge-timeout">2분</span>
                        <span class="direction-badge badge-client">→ human_response</span>
                    </div>
                </div>

                <div class="message-card server">
                    <h4><code>request_available_data</code> IndexedDB 목록 요청</h4>
                    <p>클라이언트의 IndexedDB에 저장된 데이터 목록 요청</p>
                    <div class="meta">
                        <span class="direction-badge badge-timeout">10초</span>
                        <span class="direction-badge badge-client">→ available_data</span>
                    </div>
                </div>

                <div class="message-card server">
                    <h4><code>request_api</code> IndexedDB 데이터 요청</h4>
                    <p>IndexedDB에서 데이터 조회 요청 (dataKey로 지정)</p>
                    <div class="meta">
                        <span class="direction-badge badge-timeout">60초</span>
                        <span class="direction-badge badge-client">→ api_result</span>
                    </div>
                </div>

                <div class="message-card server large-data">
                    <h4><code>request_schema</code> IndexedDB 스키마 요청</h4>
                    <p>IndexedDB 대용량 데이터의 스키마만 요청</p>
                    <div class="meta">
                        <span class="direction-badge badge-timeout">10초</span>
                        <span class="direction-badge" style="background:#EDE9FE;color:#5B21B6;">대용량</span>
                    </div>
                </div>

                <div class="message-card server large-data">
                    <h4><code>execute_code</code> IndexedDB 코드 실행</h4>
                    <p>LLM 생성 JavaScript를 IndexedDB 데이터에 대해 실행</p>
                    <div class="meta">
                        <span class="direction-badge badge-timeout">10초</span>
                        <span class="direction-badge" style="background:#EDE9FE;color:#5B21B6;">대용량</span>
                    </div>
                </div>

                <div class="message-card server">
                    <h4><code>response</code> 최종 응답</h4>
                    <p>답변 (Markdown) + suggestions + actions</p>
                    <div class="meta">
                        <span class="direction-badge badge-size">~50KB</span>
                    </div>
                </div>

                <div class="message-card server" style="border-left-color: var(--danger);">
                    <h4><code>error</code> 에러</h4>
                    <p>에러 코드 + 메시지 + retryable 여부</p>
                    <div class="meta"></div>
                </div>

                <div class="message-card server">
                    <h4><code>ping</code> 하트비트</h4>
                    <p>연결 유지 확인 (30초 주기)</p>
                    <div class="meta">
                        <span class="direction-badge badge-client">→ pong</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 메시지 흐름 -->
        <div class="card">
            <h2>메시지 흐름</h2>

            <h3>기본 질의 흐름</h3>
            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant C as Client
    participant S as Server

    C->>S: query {query, domContext}
    S->>C: response {answer, suggestions}
                </div>
            </div>

            <div class="flow-section">
                <div class="flow-card">
                    <h4>ask_human 콜백 흐름</h4>
                    <div class="mermaid">
sequenceDiagram
    participant C as Client
    participant S as Server

    S->>C: clarification_request {question, options}
    Note over S: ask_human 호출
    Note over C: [사용자 입력 대기]
    C->>S: human_response {response}
                    </div>
                </div>

                <div class="flow-card">
                    <h4>request_api 콜백 흐름 (IndexedDB)</h4>
                    <div class="mermaid">
sequenceDiagram
    participant C as Client
    participant S as Server

    S->>C: request_available_data
    C->>S: available_data {data: [...]}
    Note over S: 필요 데이터 선택
    S->>C: request_api {dataKey}
    Note over C: [IndexedDB 조회]
    C->>S: api_result {success, data}
                    </div>
                </div>
            </div>

            <h3>대용량 데이터 처리 (ProgramOfThought)</h3>
            <div class="highlight-box purple">
                <h4>핵심 원리</h4>
                <p>
                    <strong>26.6MB</strong> 데이터가 클라이언트에 있을 때, 전체를 전송하지 않고:<br>
                    ① 스키마만 전송 (~1.3KB) → ② 서버가 추출 코드 생성 (~500B) → ③ 클라이언트에서 실행 → ④ 결과만 전송 (~100B)
                </p>
            </div>

            <div class="mermaid-container">
                <div class="mermaid">
sequenceDiagram
    participant C as Client
    participant IDB as IndexedDB
    participant S as Server
    participant LLM as LLM

    Note over C: API 호출 완료, 대용량 데이터
    C->>IDB: 데이터 저장
    C->>S: api_result {isLargeData: true, cacheKey}

    S->>C: request_schema {cacheKey}
    C->>IDB: 스키마 추출
    C->>S: schema_response {schema}

    S->>LLM: 스키마 기반 코드 생성
    LLM->>S: JavaScript 코드

    S->>C: execute_code {code, cacheKey}
    C->>IDB: 원본 데이터 조회
    Note over C: eval(code) 실행
    C->>S: code_result {result}

    S->>C: response
                </div>
            </div>
        </div>

        <!-- 인터페이스 정의 -->
        <div class="card">
            <h2>주요 인터페이스 정의</h2>

            <h3>query (C→S)</h3>
            <div class="code-block"><span class="keyword">interface</span> <span class="type">QueryMessage</span> {
  <span class="property">type</span>: <span class="string">"query"</span>;
  <span class="property">query</span>: <span class="type">string</span>;                      <span class="comment">// 사용자 질문</span>
  <span class="property">domContext</span>: <span class="type">string</span>;                 <span class="comment">// 화면 DOM (~2000 토큰)</span>
  <span class="property">page</span>: {
    <span class="property">url</span>: <span class="type">string</span>;
    <span class="property">title</span>: <span class="type">string</span>;
    <span class="property">vendor</span>?: <span class="type">string</span>;                  <span class="comment">// aws, azure, gcp</span>
  };
}</div>

            <h3>request_available_data (S→C) / available_data (C→S)</h3>
            <div class="code-block"><span class="comment">// 서버가 IndexedDB 목록 요청</span>
<span class="keyword">interface</span> <span class="type">RequestAvailableDataMessage</span> {
  <span class="property">type</span>: <span class="string">"request_available_data"</span>;
  <span class="property">requestId</span>: <span class="type">string</span>;
  <span class="property">timeout</span>?: <span class="type">number</span>;                   <span class="comment">// 기본 10초</span>
}

<span class="comment">// 클라이언트가 IndexedDB 목록 응답</span>
<span class="keyword">interface</span> <span class="type">AvailableDataMessage</span> {
  <span class="property">type</span>: <span class="string">"available_data"</span>;
  <span class="property">requestId</span>: <span class="type">string</span>;
  <span class="property">data</span>: <span class="type">AvailableDataItem</span>[];
}

<span class="keyword">interface</span> <span class="type">AvailableDataItem</span> {
  <span class="property">key</span>: <span class="type">string</span>;                        <span class="comment">// IndexedDB 키</span>
  <span class="property">description</span>?: <span class="type">string</span>;               <span class="comment">// 데이터 설명</span>
  <span class="property">size</span>?: <span class="type">number</span>;                      <span class="comment">// 크기 (bytes)</span>
}</div>

            <h3>request_api (S→C) - IndexedDB 데이터 요청</h3>
            <div class="code-block"><span class="keyword">interface</span> <span class="type">RequestApiMessage</span> {
  <span class="property">type</span>: <span class="string">"request_api"</span>;
  <span class="property">requestId</span>: <span class="type">string</span>;
  <span class="property">dataKey</span>: <span class="type">string</span>;                    <span class="comment">// IndexedDB 키 (available_data에서 선택)</span>
  <span class="property">timeout</span>?: <span class="type">number</span>;                   <span class="comment">// 기본 60초</span>
}</div>

            <h3>api_result (C→S) - IndexedDB 데이터 응답</h3>
            <div class="code-block"><span class="keyword">interface</span> <span class="type">ApiResultMessage</span> {
  <span class="property">type</span>: <span class="string">"api_result"</span>;
  <span class="property">requestId</span>: <span class="type">string</span>;
  <span class="property">success</span>: <span class="type">boolean</span>;
  <span class="property">data</span>?: <span class="type">any</span>;                         <span class="comment">// IndexedDB 데이터 (100KB 미만)</span>
  <span class="property">error</span>?: { <span class="property">code</span>: <span class="type">string</span>; <span class="property">message</span>: <span class="type">string</span>; };
  <span class="comment">// 대용량 데이터인 경우</span>
  <span class="property">isLargeData</span>?: <span class="type">boolean</span>;              <span class="comment">// true면 스키마 방식</span>
  <span class="property">cacheKey</span>?: <span class="type">string</span>;                 <span class="comment">// IndexedDB 키</span>
}</div>

            <h3>schema_response (C→S)</h3>
            <div class="code-block"><span class="keyword">interface</span> <span class="type">SchemaResponseMessage</span> {
  <span class="property">type</span>: <span class="string">"schema_response"</span>;
  <span class="property">requestId</span>: <span class="type">string</span>;
  <span class="property">schema</span>: {
    <span class="property">fields</span>: <span class="type">string</span>[];                 <span class="comment">// 필드 목록</span>
    <span class="property">types</span>: <span class="type">Record</span>&lt;<span class="type">string</span>, <span class="type">string</span>&gt;;    <span class="comment">// 필드별 타입</span>
    <span class="property">totalRecords</span>: <span class="type">number</span>;            <span class="comment">// 총 레코드 수</span>
    <span class="property">estimatedSize</span>: <span class="type">number</span>;           <span class="comment">// 추정 크기 (bytes)</span>
    <span class="property">sampleData</span>?: <span class="type">any</span>[];              <span class="comment">// 샘플 1-2건</span>
  };
  <span class="property">cacheKey</span>: <span class="type">string</span>;
}</div>

            <h3>execute_code (S→C)</h3>
            <div class="code-block"><span class="keyword">interface</span> <span class="type">ExecuteCodeMessage</span> {
  <span class="property">type</span>: <span class="string">"execute_code"</span>;
  <span class="property">requestId</span>: <span class="type">string</span>;
  <span class="property">code</span>: <span class="type">string</span>;                       <span class="comment">// JavaScript 추출 코드</span>
  <span class="property">cacheKey</span>: <span class="type">string</span>;                   <span class="comment">// IndexedDB 키</span>
  <span class="property">timeout</span>?: <span class="type">number</span>;                   <span class="comment">// 기본 10초</span>
}</div>
        </div>

        <!-- 크기/타임아웃 정책 -->
        <div class="card">
            <h2>크기 및 타임아웃 정책</h2>

            <div class="flow-section">
                <div>
                    <h3>크기 제한</h3>
                    <table class="tech-table">
                        <thead>
                            <tr><th>메시지</th><th>방향</th><th>최대</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><code>query</code></td><td>C→S</td><td>50KB</td></tr>
                            <tr><td><code>api_result</code></td><td>C→S</td><td>100KB *</td></tr>
                            <tr><td><code>schema_response</code></td><td>C→S</td><td>2KB</td></tr>
                            <tr><td><code>code_result</code></td><td>C→S</td><td>1KB</td></tr>
                            <tr><td><code>response</code></td><td>S→C</td><td>50KB</td></tr>
                        </tbody>
                    </table>
                    <p style="font-size: 0.85rem; color: #6B7280;">* 초과 시 isLargeData: true로 스키마 방식</p>
                </div>

                <div>
                    <h3>타임아웃</h3>
                    <table class="tech-table">
                        <thead>
                            <tr><th>콜백</th><th>타임아웃</th><th>용도</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><code>clarification_request</code></td><td>2분</td><td>사용자 입력</td></tr>
                            <tr><td><code>request_available_data</code></td><td>10초</td><td>목록 조회</td></tr>
                            <tr><td><code>request_api</code></td><td>60초</td><td>API 호출</td></tr>
                            <tr><td><code>request_schema</code></td><td>10초</td><td>스키마 추출</td></tr>
                            <tr><td><code>execute_code</code></td><td>10초</td><td>코드 실행</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 핵심 정리 -->
        <div class="card">
            <h2>핵심 정리</h2>

            <div class="highlight-box">
                <h4>기본 메시지</h4>
                <p>
                    <code>query</code> → <code>response</code><br>
                    콜백: <code>clarification_request</code> (ask_human), <code>request_available_data</code> → <code>request_api</code> (IndexedDB 조회)
                </p>
            </div>

            <div class="highlight-box purple">
                <h4>대용량 데이터 처리 (신규)</h4>
                <p>
                    <code>api_result {isLargeData}</code> → <code>request_schema</code> → <code>schema_response</code> → <code>execute_code</code> → <code>code_result</code><br>
                    <strong>효과:</strong> 26.6MB → 스키마 1.3KB + 코드 500B + 결과 100B = 네트워크 99.99% 절감
                </p>
            </div>

            <div class="highlight-box warning">
                <h4>One-Time Token</h4>
                <p>
                    모든 콜백 요청에는 <code>requestId</code> (One-Time Token) 포함<br>
                    응답 시 같은 <code>requestId</code>를 첨부해야 서버가 검증 및 처리
                </p>
            </div>
        </div>

        <footer>
            <p>OpsNow Copilot - WebSocket Interface Definition</p>
        </footer>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: { useMaxWidth: true, htmlLabels: true, curve: 'basis' },
            sequence: { useMaxWidth: true, showSequenceNumbers: false }
        });
    </script>
</body>
</html>
